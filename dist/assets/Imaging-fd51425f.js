import{_ as F,l,H as w,G as T,m as A,r as B,o as g,e as u,b as e,q as C,I as x,F as G,j as R,f as V,d as f,N as H,t as k,h as p,k as I}from"./appInertia-949a05bd.js";import L from"./AgGridTable-e4c69b38.js";import"./AgGridTable.vue_vue_type_style_index_0_lang-f3773bde.js";const M={props:{patientId:Number,moduleId:Number,componentId:Number,stageId:Number},components:{AgGridTable:L},setup(d){let o=l(!1),m=l(0),t=l(0),_=l(null),y=l([]),c=l([]);const r=l(!1),s=l([]);let v=l([{imaging:"",imaging_date:""}]),D=l([{headerName:"Sr. No.",valueGetter:"node.rowIndex + 1",initialWidth:20},{headerName:"Imaging Date",field:"imaging_date",filter:!0,valueFormatter:a=>{const n=a.value;return n?new Date(n).toLocaleDateString("en-GB").replace(/\//g,"-"):""}},{headerName:"Imaging",field:"imaging_details"}]);const h=async()=>{try{r.value=!0,await new Promise(i=>setTimeout(i,2e3));const a=await fetch(`/ccm/care-plan-development-imaging-imaginglist/${d.patientId}`);if(!a.ok)throw new Error("Failed to fetch imaging list");r.value=!1;const n=await a.json();s.value=n.data,console.log(n.data,"imaging_Data")}catch(a){console.error("Error fetching imaging list:",a),r.value=!1}};let E=async()=>{c.value={};let a=document.getElementById("number_tracking_imaging_form"),n=new FormData(a);n.forEach((i,Ne)=>{}),f.defaults.headers.common["X-CSRF-TOKEN"]=document.querySelector('meta[name="csrf-token"]').content;try{const i=await f.post("/ccm/care-plan-development-numbertracking-imaging",n);o.value=!0,updateTimer(d.patientId,"1",d.moduleId),$(".form_start_time").val(i.form_start_time),await h(),document.getElementById("number_tracking_imaging_form").reset(),setTimeout(()=>{o.value=!1,_.value=document.getElementById("page_landing_times").value},3e3),c.value=[]}catch(i){i.response.status&&i.response.status===422?c.value=i.response.data.errors:console.error("Error submitting form:",i)}},b=async a=>{try{let n="NumberTracking-Imaging",i=await f.get(`/get_step_id/${d.moduleId}/${d.componentId}/${a}/${n}`);t.value=i.data.stepID}catch{throw new Error("Failed to fetch stageID")}};const N=async()=>{v.value.push({imaging:"",imaging_date:""})},S=async a=>{v.value.splice(a,1)};return w(()=>d.stageId,(a,n)=>{b(a)}),w(()=>o,(a,n)=>{o.value=a}),T(()=>{h()}),A(async()=>{try{_.value=document.getElementById("page_landing_times").value,b(d.stageId)}catch(a){console.error("Error on page load:",a)}}),{loading:r,submiImagingHealthDataForm:E,imagingStageId:m,imagingStepId:t,formErrors:c,imagingTime:_,showImagingAlert:o,imagingColumnDefs:D,imagingRowData:s,fetchPatientImagingList:h,imaging:y,imagingItems:v,addImagingItem:N,removeImagingItem:S}}},P={class:"tab-pane fade show active",id:"imaging",role:"tabpanel","aria-labelledby":"imaging-icon-pill"},j={class:"card"},q=e("div",{class:"card-header"},[e("h4",null,"Imaging")],-1),z=e("button",{type:"button",class:"close","data-dismiss":"alert"},"x",-1),K=e("strong",null," Imaging data saved successfully! ",-1),O=e("span",{id:"text"},null,-1),W=[z,K,O],X={class:"col-md-12"},J=["value"],Q=["value"],U=e("input",{type:"hidden",name:"start_time",value:"00:00:00"},null,-1),Y=e("input",{type:"hidden",name:"end_time",value:"00:00:00"},null,-1),Z=["value"],ee=["value"],te=["value"],ae=["value"],ne=e("input",{type:"hidden",name:"form_name",value:"number_tracking_imaging_form"},null,-1),ie=e("input",{type:"hidden",name:"billable",value:"1"},null,-1),oe=["value"],se=e("input",{type:"hidden",class:"imaging_id",id:"imaging_id"},null,-1),le={class:"col-md-4"},re=e("label",null,[I("Imaging : "),e("span",{class:"error"},"*")],-1),de=e("input",{type:"text",name:"imaging[]",placeholder:"Enter Imaging",class:"forms-element form-control"},null,-1),me={key:0,class:"invalid-feedback",style:{display:"block"}},ce={class:"col-md-4"},ge=e("label",null,[I("Date"),e("span",{class:"error"},"*"),I(" :")],-1),ue=e("input",{type:"date",name:"imaging_date[]",class:"forms-element form-control"},null,-1),_e={key:0,class:"invalid-feedback",style:{display:"block"}},ve={class:"col-md-1"},he=["onClick"],fe=e("hr",null,null,-1),pe=e("i",{class:"plus-icons i-Add",id:"add_imaging",title:"Add imaging"},null,-1),Ie=[pe],ye=H('<div class="card-footer"><div class="mc-footer"><div class="row"><div class="col-lg-12 text-right"><button type="submit" class="btn btn-primary m-1" id="save_number_tracking_imaging_form">Save</button></div></div></div></div><div class="alert alert-danger" id="danger-alert" style="display:none;"><button type="button" class="close" data-dismiss="alert">x</button><strong> Please Fill All mandatory Fields! </strong><span id="text"></span></div>',2),be=e("div",{class:"separator-breadcrumb border-top"},null,-1),we={class:"row"},ke={class:"col-12"},De={class:"table-responsive"};function Ee(d,o,m,t,_,y){const c=B("AgGridTable");return g(),u("div",P,[e("div",j,[q,e("form",{id:"number_tracking_imaging_form",name:"number_tracking_imaging_form",onSubmit:o[1]||(o[1]=C((...r)=>t.submiImagingHealthDataForm&&t.submiImagingHealthDataForm(...r),["prevent"]))},[e("div",{class:"alert alert-success",style:x({display:t.showImagingAlert?"block":"none"})},W,4),e("div",X,[e("input",{type:"hidden",name:"uid",value:m.patientId},null,8,J),e("input",{type:"hidden",name:"patient_id",value:m.patientId},null,8,Q),U,Y,e("input",{type:"hidden",name:"module_id",value:m.moduleId},null,8,Z),e("input",{type:"hidden",name:"component_id",value:m.componentId},null,8,ee),e("input",{type:"hidden",name:"stage_id",value:t.imagingStageId},null,8,te),e("input",{type:"hidden",name:"step_id",value:t.imagingStepId},null,8,ae),ne,ie,e("input",{type:"hidden",name:"timearr[form_start_time]",class:"timearr form_start_time",value:t.imagingTime},null,8,oe),(g(!0),u(G,null,R(t.imagingItems,(r,s)=>(g(),u("div",{key:s,class:"form-row"},[se,e("div",le,[re,de,t.formErrors["imaging."+s]?(g(),u("div",me,k(t.formErrors["imaging."+s][0]),1)):p("",!0)]),e("div",ce,[ge,ue,t.formErrors["imaging_date."+s]?(g(),u("div",_e,k(t.formErrors["imaging_date."+s][0]),1)):p("",!0)]),e("div",ve,[s>0?(g(),u("i",{key:0,class:"remove-icons i-Remove float-right mb-3",title:"Remove Follow-up Task",onClick:v=>t.removeImagingItem(s)},null,8,he)):p("",!0)])]))),128)),fe,e("div",{onClick:o[0]||(o[0]=(...r)=>t.addImagingItem&&t.addImagingItem(...r))},Ie)]),ye],32),be,e("div",we,[e("div",ke,[e("div",De,[V(c,{rowData:t.imagingRowData,columnDefs:t.imagingColumnDefs},null,8,["rowData","columnDefs"])])])])])])}const Ae=F(M,[["render",Ee]]);export{Ae as default};
