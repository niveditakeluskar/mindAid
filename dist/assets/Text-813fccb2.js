import{_ as u,d,o,e as a,b as e,t as r,h as n,i as p,v as b,F as h,j as g,k as m}from"./appInertia-949a05bd.js";const v={props:{patientId:Number,moduleId:Number,componentId:Number,formErrors:String},data(){return{selectedTextTemplate:null,textTemplates:null,textScripts:null,valid:null,mob_number:null,mobval:null,mob:null,home_number:null,home_number_value:null,home:null,stageId:null}},mounted(){this.fetchTextTemplate(),this.fetchMessageContent()},methods:{async fetchMessageContent(){await d.get(`/ccm/get-calltext/${this.moduleId}/${this.patientId}/${this.componentId}/call_message`).then(s=>{this.valid=s.data.valid,this.mob_number=s.data.mob_number,this.mobval=s.data.mobval,this.mob=s.data.mob,this.home_number=s.data.home_number,this.home_number_value=s.data.home_number_value,this.home=s.data.home}).catch(s=>{console.error("Error fetching data:",s)})},async fetchTextTemplate(){let s="Text",i=await d.get(`/get_stage_id/${this.moduleId}/${this.componentId}/${s}`);this.stageId=i.data.stageID,await d.get(`/org/get_content_scripts/${this.moduleId}/${this.componentId}/${this.stageId}/0/content_template`).then(l=>{this.textTemplates=l.data,console.log("textTemplates",l.data),this.selectedTextTemplate=this.textTemplates[this.textTemplates.length-1].id,this.textScript(this.selectedTextTemplate)}).catch(l=>{console.error("Error fetching data:",l)})},async textScript(s){await d.get(`/ccm/get-call-scripts-by-id/${s}/${this.patientId}/call-script`).then(i=>{this.textScripts=i.data.finaldata,this.textScripts=this.textScripts.replace(/(<([^>]+)>)/ig,""),this.textScripts=this.textScripts.replace(/&nbsp;/g," "),this.textScripts=this.textScripts.replace(/&amp;/g,"&")}).catch(i=>{console.error("Error fetching data:",i)})}}},x=e("div",{class:"card-title"},"Text",-1),f={class:"mb-4"},T={key:0,class:"form-group",id:"template_content"},y=e("div",{class:"twilo-error"},null,-1),k={class:"row"},S={class:"col-md-4 form-group mb-3",id:"cntctlist"},I=e("label",null,[m("Contact No."),e("span",{class:"error"},"*")],-1),w={class:"custom-select",name:"contact_no",id:"text_contact_number"},E=e("option",{value:""},"Choose Contact Number",-1),N=["value"],C=["value"],P={key:0,class:"invalid-feedback",style:{display:"block"}},M={class:"col-md-8 form-group mb-3"},V=e("label",null,[m("Template "),e("span",{class:"error"},"*")],-1),B=e("option",{value:"0"},"Select Template",-1),D=["value"],z={key:0,class:"invalid-feedback",style:{display:"block"}},F={key:0,class:"alert alert-warning mt-2 ml-2"},O={class:"row",id:"textarea"},U={class:"col-md-8 offset-4 form-group mb-3"},j=e("label",null,[m("Message "),e("span",{class:"error"},"*")],-1),L={name:"message",class:"forms-element form-control",id:"templatearea_sms",style:{height:"50px","overflow-y":"hidden"}},q={key:0,class:"invalid-feedback",style:{display:"block"}},A={key:1,class:"alert alert-warning mt-2 ml-2"},G=e("input",{type:"hidden",name:"error",value:"Texting has been disabled for the system."},null,-1),H={key:2,class:"alert alert-warning mt-2 ml-2"},J=e("input",{type:"hidden",name:"error",value:"Texting is disabled for Patient's Organization."},null,-1),K={key:3,class:"alert alert-warning mt-2 ml-2"},Q=e("input",{type:"hidden",name:"error",value:"Patient has not given consent to send text message."},null,-1);function R(s,i,l,W,t,_){return o(),a(h,null,[x,e("div",f,[t.valid==1?(o(),a("div",T,[y,e("div",k,[e("div",S,[I,e("select",w,[E,t.mob==1?(o(),a("option",{key:0,value:t.mobval},r(t.mob_number)+" (P)",9,N)):n("",!0),t.home==1?(o(),a("option",{key:1,value:t.home_number_value},r(t.home_number)+" (s)",9,C)):n("",!0)]),l.formErrors.contact_no?(o(),a("div",P,r(l.formErrors.contact_no[0]),1)):n("",!0)]),e("div",M,[V,p(e("select",{name:"template",id:"text_template_id",class:"custom-select show-tick custom-select","onUpdate:modelValue":i[0]||(i[0]=c=>t.selectedTextTemplate=c),onChange:i[1]||(i[1]=c=>_.textScript(t.selectedTextTemplate))},[B,(o(!0),a(h,null,g(t.textTemplates,c=>(o(),a("option",{key:c.id,value:c.id},r(c.content_title),9,D))),128))],544),[[b,t.selectedTextTemplate]]),l.formErrors.template?(o(),a("div",z,r(l.formErrors.template[0]),1)):n("",!0)]),t.mob==0&&t.home==0?(o(),a("div",F,"Patient Cell Number is Unavailable. Text Message cannot be sent to this patient.")):n("",!0)]),e("div",O,[e("div",U,[j,e("textarea",L,r(t.textScripts),1),l.formErrors.message?(o(),a("div",q,r(l.formErrors.message[0]),1)):n("",!0)])])])):n("",!0),t.valid==2?(o(),a("div",A,"Texting has been disabled for the system")):n("",!0),m(),G,t.valid==3?(o(),a("div",H,"Texting is disabled for Patient's Organization")):n("",!0),m(),J,t.valid==0?(o(),a("div",K,"Patient has not given consent to send text message")):n("",!0),m(),Q])],64)}const Y=u(v,[["render",R]]);export{Y as default};
