import g from"./CallHistory-484a964a.js";import I from"./TextMessage-9cf25f50.js";import{C as A}from"./ContactTime-418bf844.js";import{_ as N,d,r as p,o as i,e as a,b as t,q as b,I as k,i as _,R as u,t as c,h as r,F as h,j as f,v,c as w,f as E,k as x}from"./appInertia-bd981cc7.js";const T={props:{patientId:Number,moduleId:Number,componentId:Number},data(){return{callAnswerContentScript:null,selectedCallAnswerdContentScript:null,callNotAnswerContentScript:null,selectedCallNotAnswerdContentScript:null,callNotScript:null,callStatus:null,voiceMailAction:0,callAnsSelectes:null,callNotAnsSelectes:null,callContinueStatus:null,formErrors:{},stageId:null,callAnsStepId:null,callNotAnsStepId:null,showAlert:!1,renderComponent:!0,timerStatus:null}},components:{CallHistory:g,SendTextMessage:I,ContactTime:A},mounted(){this.time=document.getElementById("page_landing_times").value,this.timerStatus=document.getElementById("timer_runing_status").value,this.getStageID()},methods:{async getStageID(){try{let o="Call",l=await d.get(`/get_stage_id/${this.moduleId}/${this.componentId}/${o}`);this.stageId=l.data.stageID}catch{throw new Error("Failed to fetch stageID")}},async fetchCallAnswerContentScript(){setTimeout(()=>{let o="Call_Answered";d.get(`/get_step_id/${this.moduleId}/${this.componentId}/${this.stageId}/${o}`).then(l=>{this.callAnsStepId=l.data.stepID,this.fetchCallAnswerContentScripts()}).catch(l=>{console.error("Error fetching data:",l)})},500)},async fetchCallAnswerContentScripts(){await d.get(`/org/get_content_scripts/${this.moduleId}/${this.componentId}/${this.stageId}/${this.callAnsStepId}/content_template`).then(o=>{this.callAnswerContentScript=o.data,this.callAnsSelectes=this.callAnswerContentScript[this.callAnswerContentScript.length-1].id,this.callAnsScript(this.callAnsSelectes)}).catch(o=>{console.error("Error fetching data:",o)})},async fetchCallNotAnswerContentScript(){setTimeout(()=>{let o="Call_Not_Answered";d.get(`/get_step_id/${this.moduleId}/${this.componentId}/${this.stageId}/${o}`).then(l=>{this.callNotAnsStepId=l.data.stepID,this.fetchCallNotAnswerContentScripts()}).catch(l=>{console.error("Error fetching data:",l)})},500)},async fetchCallNotAnswerContentScripts(){await d.get(`/org/get_content_scripts/${this.moduleId}/${this.componentId}/${this.stageId}/${this.callNotAnsStepId}/content_template`).then(o=>{this.callNotAnswerContentScript=o.data,this.selectedCallNotAnswerdContentScript=this.callNotAnswerContentScript[this.callNotAnswerContentScript.length-1].id,this.callNotAnsScript(this.selectedCallNotAnswerdContentScript)}).catch(o=>{console.error("Error fetching data:",o)})},async callAnsScript(o){await d.get(`/ccm/get-call-scripts-by-id/${o}/${this.patientId}/call-script`).then(l=>{this.selectedCallAnswerdContentScript=l.data.finaldata,this.selectedCallAnswerdContentScript=this.selectedCallAnswerdContentScript.replace(/(<([^>]+)>)/ig,""),this.selectedCallAnswerdContentScript=this.selectedCallAnswerdContentScript.replace(/&nbsp;/g," "),this.selectedCallAnswerdContentScript=this.selectedCallAnswerdContentScript.replace(/&amp;/g,"&")}).catch(l=>{console.error("Error fetching data:",l)})},async callNotAnsScript(o){await d.get(`/ccm/get-call-scripts-by-id/${o}/${this.patientId}/call-script`).then(l=>{this.callNotScript=l.data.finaldata,this.callNotScript=this.callNotScript.replace(/(<([^>]+)>)/ig,""),this.callNotScript=this.callNotScript.replace(/&nbsp;/g," "),this.callNotScript=this.callNotScript.replace(/&amp;/g,"&")}).catch(l=>{console.error("Error fetching data:",l)})},async submitCallForm(){let o=document.getElementById("callstatus_form"),l=new FormData(o);this.renderComponent=!1,d.defaults.headers.common["X-CSRF-TOKEN"]=document.querySelector('meta[name="csrf-token"]').content;try{this.formErrors={};const n=await d.post("/ccm/monthly-monitoring-call-callstatus",l);n&&n.status==200&&(this.renderComponent=!0,this.showAlert=!0,updateTimer(this.patientId,1,this.moduleId),$(".form_start_time").val(n.data.form_start_time),setTimeout(()=>{this.time=document.getElementById("page_landing_times").value,this.showAlert=!1},3e3),this.$emit("form-submitted"))}catch(n){n.response&&n.response.status===422?this.formErrors=n.response.data.errors:console.error("Error submitting form:",n)}}}},M={class:"tsf-step-content"},V={class:"row"},F={class:"col-lg-12 mb-3"},D=["value"],B=["value"],U=t("input",{type:"hidden",name:"start_time",value:"00:00:00"},null,-1),H=t("input",{type:"hidden",name:"end_time",value:"00:00:00"},null,-1),R=["value"],q=["value"],L=["value"],j=t("input",{type:"hidden",name:"template_type_id",value:"2"},null,-1),z=t("input",{type:"hidden",name:"form_name",value:"callstatus_form"},null,-1),K=["value"],O=["value"],X=t("input",{type:"hidden",name:"content_title"},null,-1),Y=t("input",{type:"hidden",name:"call_not_text_message"},null,-1),G=t("input",{type:"hidden",name:"billable",value:"1"},null,-1),J=t("input",{type:"hidden",name:"hourtime",id:"hourtime"},null,-1),P=["value"],Q={class:"card"},W=t("button",{type:"button",class:"close","data-dismiss":"alert"},"x",-1),Z=t("strong",null,"Call data saved successfully! ",-1),tt=t("span",{id:"text"},null,-1),et=[W,Z,tt],lt=t("div",{class:"twilo-error"},null,-1),st={class:"card-body"},ot={class:"row"},nt={class:"col-md-3"},it={class:"forms-element"},at={class:"form-row"},ct=t("span",{class:"col-md-8 float-left"},"Call Answered",-1),rt={for:"answered",class:"radio radio-primary col-md-4"},dt=t("span",{class:"checkmark"},null,-1),_t={class:"form-row"},mt=t("span",{class:"col-md-8 float-left"},"Call Not Answered",-1),ut={for:"not_answered",class:"radio radio-primary col-md-4"},pt=t("span",{class:"checkmark"},null,-1),ht={key:0,class:"form-row invalid-feedback",style:{display:"block"}},ft={key:0,class:"col-md-8",id:"callAnswer"},vt={name:"call_answer_template_id",class:"custom-select show-tick select2"},wt=t("option",{value:""},"Select Template",-1),Ct=["value","selected"],St=t("br",null,null,-1),yt=t("h6",null,"Introduction Script",-1),gt={class:"call_answer_template"},It={hidden:"hidden",name:"call_answer_template",class:"form-control call_answer_template",id:"call_answer_template"},At={class:""},Nt=t("span",null,[x("Is this good time to talk? "),t("span",{class:"error"},"*")],-1),bt=t("br",null,null,-1),kt={class:"form-row forms-element"},Et={class:"radio radio-primary col-md-4 float-left"},xt=t("span",null,"Yes",-1),Tt=t("span",{class:"checkmark"},null,-1),Mt={class:"radio radio-primary col-md-4 float-left"},Vt=t("span",null,"No",-1),Ft=t("span",{class:"checkmark"},null,-1),Dt={key:0,class:"form-row invalid-feedback",style:{display:"block"}},Bt={key:0,class:"row mb-3",id:"schedule_call_ans_next_call"},Ut={class:"col-md-6"},Ht=t("span",null,"Select Call Follow-up date: ",-1),Rt=t("input",{type:"date",name:"answer_followup_date",id:"answer_followup_date",class:"forms-element form-control"},null,-1),qt={key:0,id:"call_continue_followup_date_error",class:"invalid-feedback",style:{display:"block"}},Lt=t("div",{class:"col-md-6"},[t("span",null,"Select Call Follow-up Time:"),t("input",{type:"time",name:"answer_followup_time",id:"answer_followup_time",class:"forms-element form-control"})],-1),jt={key:1,class:"col-md-6",id:"callNotAnswer"},zt={class:"mb-3"},Kt=t("option",{value:"0",selected:""},"Select Voice Mail Action",-1),Ot=t("option",{value:"1"},"Left Voice Mail",-1),Xt=t("option",{value:"2"},"No Voice Mail",-1),Yt=t("option",{value:"3"},"Send Text Message",-1),Gt=[Kt,Ot,Xt,Yt],Jt={key:0,class:"invalid-feedback",style:{display:"block"}},Pt={key:0,class:"row",id:"voicetextarea"},Qt={class:"col-md-12 form-group mb-3"},Wt=t("option",{value:""},"Select Template",-1),Zt=["value"],$t=t("br",null,null,-1),te=t("h6",null,"Voice Mail Script",-1),ee={class:"voice_mail_template"},le={hidden:"hidden",name:"voice_template",class:"form-control voice_mail_template",style:{padding:"5px",width:"47em","min-height":"5em",overflow:"auto",height:"87px"},id:"voice_mail_template"},se={class:"mb-3"},oe=t("span",null,"Select Call Follow-up date: ",-1),ne=t("input",{type:"date",name:"call_followup_date",id:"call_followup_date",class:"forms-element form-control"},null,-1),ie={key:0,id:"call_followup_date_error",class:"invalid-feedback",style:{display:"block"}},ae=t("hr",null,null,-1),ce=t("div",{class:"col-12 text-center"},[t("h3",null,"Best Time to contact")],-1),re={class:"card-footer"},de={class:"mc-footer"},_e={class:"row"},me={class:"col-lg-12 text-right",id:"call-save-button"},ue=["disabled"];function pe(o,l,n,he,e,m){const C=p("SendTextMessage"),S=p("ContactTime"),y=p("CallHistory");return i(),a("div",M,[t("div",V,[t("div",F,[t("form",{id:"callstatus_form",name:"callstatus_form",onSubmit:l[9]||(l[9]=b((...s)=>m.submitCallForm&&m.submitCallForm(...s),["prevent"]))},[t("input",{type:"hidden",name:"uid",value:n.patientId},null,8,D),t("input",{type:"hidden",name:"patient_id",value:n.patientId},null,8,B),U,H,t("input",{type:"hidden",name:"module_id",value:n.moduleId},null,8,R),t("input",{type:"hidden",name:"component_id",value:n.componentId},null,8,q),t("input",{type:"hidden",name:"stage_id",value:e.stageId},null,8,L),j,z,t("input",{type:"hidden",name:"call_answered_step_id",value:e.callAnsStepId},null,8,K),t("input",{type:"hidden",name:"call_notanswered_step_id",value:e.callNotAnsStepId},null,8,O),X,Y,G,J,t("input",{type:"hidden",name:"timearr[form_start_time]",class:"timearr form_start_time",value:o.time},null,8,P),t("div",Q,[t("div",{class:"alert alert-success",id:"success-alert",style:k({display:e.showAlert?"block":"none"})},et,4),lt,t("div",st,[t("div",ot,[t("div",nt,[t("span",it,[t("div",at,[ct,t("label",rt,[_(t("input",{type:"radio",name:"call_status",value:"1",formControlName:"radio",onClick:l[0]||(l[0]=s=>m.fetchCallAnswerContentScript()),id:"answered","onUpdate:modelValue":l[1]||(l[1]=s=>e.callStatus=s)},null,512),[[u,e.callStatus]]),dt])]),t("div",_t,[mt,t("label",ut,[_(t("input",{type:"radio",name:"call_status",value:"2",formControlName:"radio",onClick:l[2]||(l[2]=s=>m.fetchCallNotAnswerContentScript()),id:"not_answered","onUpdate:modelValue":l[3]||(l[3]=s=>e.callStatus=s)},null,512),[[u,e.callStatus]]),pt])])]),e.formErrors.call_status?(i(),a("div",ht,c(e.formErrors.call_status[0]),1)):r("",!0)]),e.callStatus==1?(i(),a("div",ft,[t("select",vt,[wt,(i(!0),a(h,null,f(e.callAnswerContentScript,s=>(i(),a("option",{key:s.id,value:s.id,selected:s.id==e.callAnsSelectes},c(s.content_title),9,Ct))),128))]),t("span",null,[St,yt,t("div",gt,c(e.selectedCallAnswerdContentScript),1),t("textarea",It,c(e.selectedCallAnswerdContentScript),1)]),t("div",At,[Nt,bt,t("div",kt,[t("label",Et,[_(t("input",{type:"radio",id:"role1",class:"",name:"call_continue_status",value:"1",formControlName:"radio","onUpdate:modelValue":l[4]||(l[4]=s=>e.callContinueStatus=s)},null,512),[[u,e.callContinueStatus]]),xt,Tt]),t("label",Mt,[_(t("input",{type:"radio",id:"role2",class:"",name:"call_continue_status",value:"0",formControlName:"radio","onUpdate:modelValue":l[5]||(l[5]=s=>e.callContinueStatus=s)},null,512),[[u,e.callContinueStatus]]),Vt,Ft])]),e.formErrors.call_continue_status?(i(),a("div",Dt,c(e.formErrors.call_continue_status[0]),1)):r("",!0)]),e.callContinueStatus==0?(i(),a("div",Bt,[t("div",Ut,[Ht,Rt,e.formErrors.answer_followup_date?(i(),a("div",qt,c(e.formErrors.answer_followup_date[0]),1)):r("",!0)]),Lt])):r("",!0)])):r("",!0),e.callStatus==2?(i(),a("div",jt,[t("div",zt,[_(t("select",{class:"forms-element custom-select",id:"answer",name:"voice_mail","onUpdate:modelValue":l[6]||(l[6]=s=>e.voiceMailAction=s)},Gt,512),[[v,e.voiceMailAction]]),e.formErrors.voice_mail?(i(),a("div",Jt,c(e.formErrors.voice_mail[0]),1)):r("",!0)]),e.voiceMailAction==1?(i(),a("div",Pt,[t("div",Qt,[_(t("select",{name:"voice_scripts_select",class:"custom-select show-tick select2",onChange:l[7]||(l[7]=s=>m.callNotAnsScript(e.selectedCallNotAnswerdContentScript)),"onUpdate:modelValue":l[8]||(l[8]=s=>e.selectedCallNotAnswerdContentScript=s)},[Wt,(i(!0),a(h,null,f(e.callNotAnswerContentScript,s=>(i(),a("option",{key:s.id,value:s.id},c(s.content_title),9,Zt))),128))],544),[[v,e.selectedCallNotAnswerdContentScript]]),t("span",null,[$t,te,t("div",ee,c(e.callNotScript),1),t("textarea",le,c(e.callNotScript),1)])])])):r("",!0),e.voiceMailAction==3?(i(),w(C,{key:1,patientId:n.patientId,moduleId:n.moduleId,componentId:n.componentId,stageId:e.stageId,stepId:e.callNotAnsStepId,formErrors:e.formErrors},null,8,["patientId","moduleId","componentId","stageId","stepId","formErrors"])):r("",!0),t("div",se,[oe,ne,e.formErrors.call_followup_date?(i(),a("div",ie,c(e.formErrors.call_followup_date[0]),1)):r("",!0)])])):r("",!0)]),t("div",null,[ae,ce,E(S)])]),t("div",re,[t("div",de,[t("div",_e,[t("div",me,[t("button",{type:"submit",class:"btn btn-primary m-1",id:"save-callstatus",disabled:e.timerStatus==1},"Next",8,ue)])])])])])],32),e.renderComponent?(i(),w(y,{key:0,patientId:n.patientId},null,8,["patientId"])):r("",!0)])])])}const Se=N(T,[["render",pe]]);export{Se as default};
