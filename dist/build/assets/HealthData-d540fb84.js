import{_ as F,l as d,H as I,G as H,m as T,r as A,o as h,e as _,b as e,q as B,I as x,F as C,j as G,f as R,d as p,N as V,t as D,h as g,k as y}from"./appInertia-bd981cc7.js";import L from"./AgGridTable-ef5374d2.js";import"./AgGridTable.vue_vue_type_style_index_0_lang-56c71005.js";const M={props:{patientId:Number,moduleId:Number,componentId:Number,stageId:Number},components:{AgGridTable:L},setup(i){let s=d(!1),c=d(0),t=d(0),u=d(null),b=d([]),m=d([]);const r=d(!1),n=d([]);let v=d([{health_data:"",healthdata_date:""}]),w=d([{headerName:"Sr. No.",valueGetter:"node.rowIndex + 1",initialWidth:20},{headerName:"Health Date",field:"health_date",filter:!0,valueFormatter:a=>{const o=a.value;return o?new Date(o).toLocaleDateString("en-GB").replace(/\//g,"-"):""}},{headerName:"Health Data",field:"health_data"}]);const f=async()=>{try{r.value=!0,await new Promise(l=>setTimeout(l,2e3));const a=await fetch(`/ccm/care-plan-development-health-healthlist/${i.patientId}`);if(!a.ok)throw new Error("Failed to fetch health data list");r.value=!1;const o=await a.json();n.value=o.data}catch(a){console.error("Error fetching health data list:",a),r.value=!1}};let k=async()=>{m.value={};let a=document.getElementById("number_tracking_healthdata_form"),o=new FormData(a);o.forEach((l,Ee)=>{}),p.defaults.headers.common["X-CSRF-TOKEN"]=document.querySelector('meta[name="csrf-token"]').content;try{const l=await p.post("/ccm/care-plan-development-numbertracking-healthdata",o);l&&l.status==200&&(s.value=!0,updateTimer(i.patientId,"1",i.moduleId),$(".form_start_time").val(l.data.form_start_time),await f(),document.getElementById("number_tracking_healthdata_form").reset(),setTimeout(()=>{s.value=!1,u.value=document.getElementById("page_landing_times").value},3e3),m.value=[])}catch(l){l.response.status&&l.response.status===422?m.value=l.response.data.errors:console.error("Error submitting form:",l)}},E=async a=>{try{let o="NumberTracking-Health_Data",l=await p.get(`/get_step_id/${i.moduleId}/${i.componentId}/${a}/${o}`);t.value=l.data.stepID}catch{throw new Error("Failed to fetch stageID")}};const S=async()=>{v.value.push({health_data:"",healthdata_date:""})},N=async a=>{v.value.splice(a,1)};return I(()=>i.stageId,(a,o)=>{E(a)}),I(()=>s,(a,o)=>{s.value=a}),H(()=>{f()}),T(async()=>{try{u.value=document.getElementById("page_landing_times").value}catch(a){console.error("Error on page load:",a)}}),{loading:r,fetchPatientHealthDataList:f,healthdataStageId:c,healthdataStepId:t,formErrors:m,healthdataTime:u,showImagingAlert:s,columnDefs:w,healthdataRowData:n,fetchPatientHealthDataList:f,deleteServices,editService,healthdata:b,healthdataItems:v,addImagingItem:S,removeImagingItem:N,submitHealthDataForm:k}}},P={class:"tab-pane fade show active",id:"healthdata",role:"tabpanel","aria-labelledby":"healthdata-icon-pill"},j={class:"card"},q=e("div",{class:"card-header"},[e("h4",null,"Health Data")],-1),z=e("button",{type:"button",class:"close","data-dismiss":"alert"},"x",-1),K=e("strong",null," Health Data data saved successfully! ",-1),O=e("span",{id:"text"},null,-1),W=[z,K,O],X={class:"col-md-12"},J=["value"],Q=["value"],U=e("input",{type:"hidden",name:"start_time",value:"00:00:00"},null,-1),Y=e("input",{type:"hidden",name:"end_time",value:"00:00:00"},null,-1),Z=["value"],ee=["value"],te=["value"],ae=["value"],le=e("input",{type:"hidden",name:"form_name",value:"number_tracking_healthdata_form"},null,-1),oe=e("input",{type:"hidden",name:"billable",value:"1"},null,-1),se=["value"],ne={class:"col-md-4"},de=e("label",null,[y("Health Data:"),e("span",{class:"error"},"*")],-1),re=e("input",{type:"text",name:"health_data[]",placeholder:"Enter Health Data",class:"forms-element form-control"},null,-1),ie={key:0,class:"invalid-feedback",style:{display:"block"}},ce={class:"col-md-4"},me=e("label",null,[y("Date"),e("span",{class:"error"},"*"),y(" :")],-1),he=e("input",{type:"date",name:"health_date[]",class:"forms-element form-control"},null,-1),_e={key:0,class:"invalid-feedback",style:{display:"block"}},ue={class:"col-md-1"},ve=["onClick"],fe=e("hr",null,null,-1),pe=e("i",{class:"plus-icons i-Add",id:"add_healthdata",title:"Add health_data"},null,-1),ge=[pe],ye=V('<div class="card-footer"><div class="mc-footer"><div class="row"><div class="col-lg-12 text-right"><button type="submit" class="btn btn-primary m-1" id="save_number_tracking_healthdata_form">Save</button></div></div></div></div><div class="alert alert-danger" id="danger-alert" style="display:none;"><button type="button" class="close" data-dismiss="alert">x</button><strong> Please Fill All mandatory Fields! </strong><span id="text"></span></div>',2),be=e("div",{class:"separator-breadcrumb border-top"},null,-1),Ie={class:"row"},De={class:"col-12"},we={class:"table-responsive"};function ke(i,s,c,t,u,b){const m=A("AgGridTable");return h(),_("div",P,[e("div",j,[q,e("form",{id:"number_tracking_healthdata_form",name:"number_tracking_healthdata_form",onSubmit:s[1]||(s[1]=B((...r)=>t.submitHealthDataForm&&t.submitHealthDataForm(...r),["prevent"]))},[e("div",{class:"alert alert-success",style:x({display:t.showImagingAlert?"block":"none"})},W,4),e("div",X,[e("input",{type:"hidden",name:"uid",value:c.patientId},null,8,J),e("input",{type:"hidden",name:"patient_id",value:c.patientId},null,8,Q),U,Y,e("input",{type:"hidden",name:"module_id",value:c.moduleId},null,8,Z),e("input",{type:"hidden",name:"component_id",value:c.componentId},null,8,ee),e("input",{type:"hidden",name:"stage_id",value:t.healthdataStageId},null,8,te),e("input",{type:"hidden",name:"step_id",value:t.healthdataStepId},null,8,ae),le,oe,e("input",{type:"hidden",name:"timearr[form_start_time]",class:"timearr form_start_time",value:t.healthdataTime},null,8,se),(h(!0),_(C,null,G(t.healthdataItems,(r,n)=>(h(),_("div",{key:n,class:"form-row"},[e("div",ne,[de,re,t.formErrors["health_data."+n]?(h(),_("div",ie,D(t.formErrors["health_data."+n][0]),1)):g("",!0)]),e("div",ce,[me,he,t.formErrors["health_date."+n]?(h(),_("div",_e,D(t.formErrors["health_date."+n][0]),1)):g("",!0)]),e("div",ue,[n>0?(h(),_("i",{key:0,class:"remove-icons i-Remove float-right mb-3",title:"Remove Follow-up Task",onClick:v=>t.removeImagingItem(n)},null,8,ve)):g("",!0)])]))),128)),fe,e("div",{onClick:s[0]||(s[0]=(...r)=>t.addImagingItem&&t.addImagingItem(...r))},ge)]),ye],32),be,e("div",Ie,[e("div",De,[e("div",we,[R(m,{rowData:t.healthdataRowData,columnDefs:t.columnDefs},null,8,["rowData","columnDefs"])])])])])])}const He=F(M,[["render",ke]]);export{He as default};
